around=c(0)
#Create dataframe of measures at different points
df.meanmeasures.evolution=around%>%map_dfr(function(x)  df.measures %>% left_join(df.maxdeaths, by = 'RegionName') %>%
filter(date > (date.min30+x) & date < (date.plus30+x))%>%mutate(reference=x)%>% group_by(RegionName,reference) %>% summarise_if(is.numeric, mean, na.rm = TRUE) %>%
mutate(across(where(is.numeric), round, 3)))
df.meanmeasures.evolution
View(df.meanmeasures.evolution)
pca_fit$center
pca_fit$scale
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( 0,1)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
pca_fit$center
pca_fit$center%>%length()
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=1) %*% pca_fit$rotation%>%
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=1)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=rep(1,8)) %*% pca_fit$rotation%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=rep(1,8)) %*% pca_fit$rotation%>%
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=rep(1,8))) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=rep(1,17))) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
evolution.measures
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=rep(1,17))) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
ggplot(evolution.measures%>%filter(reference==0),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+xlim(-6,6)+ylim(-3,3)
?prcomp
#df.pca=df.pca%>%replace_na(list(0))%>%mutate(across(where(is.numeric),scale))
pca_fit <- select(df.pca[,], -RegionName) %>%
prcomp(scale=T); summary(pca_fit)
pca_fit$scale
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=pca_fit$center,scale=center=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=pca_fit$center,scale=center=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale(center=pca_fit$center,scale=center=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=pca_fit$center,scale=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
evolution.measures
ggplot(evolution.measures%>%filter(reference==0),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+xlim(-6,6)+ylim(-3,3)
ggplot(evolution.measures%>%filter(reference==0),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()
evolution.measures
ggplot(evolution.measures%>%filter(reference==0),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+geom_text(aes(label=RegionName))
pca_fit
pca_fit$x
ggplot(evolution.measures%>%filter(reference==0),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+geom_text(aes(label=RegionName))+xlim(-6,6)+ylim(-3,3)
pca_fit$center
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=rep(0,17),scale=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
ggplot(evolution.measures%>%filter(reference==0),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+geom_text(aes(label=RegionName))+xlim(-6,6)+ylim(-3,3)
pca_fit$center
pca_fit$scale
#Start with df
##2.1 PCA exploratory analysis
df.pca=df.aroundpeak.meanmeasures%>%select(-'H5_Investment in vaccines',-'newdeaths')
df.pca=df.pca%>%replace_na(list(0))%>%mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))
#df.pca=df.pca%>%replace_na(list(0))%>%mutate(across(where(is.numeric),scale))
pca_fit <- select(df.pca[,], -RegionName) %>%
prcomp(scale=T); summary(pca_fit)
#Create dataframe of measures at different points
df.meanmeasures.evolution=around%>%map_dfr(function(x)  df.measures %>% left_join(df.maxdeaths, by = 'RegionName') %>%
filter(date > (date.min30+x) & date < (date.plus30+x))%>%mutate(reference=x)%>% group_by(RegionName,reference) %>% summarise_if(is.numeric, mean, na.rm = TRUE) %>%
mutate(across(where(is.numeric), round, 3)))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=pca_fit$center,scale=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
ggplot(evolution.measures%>%filter(reference==0),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+geom_text(aes(label=RegionName))
#Define times of analysis
around=c(-60,-45,-15,0,15,30,45,60)
#Create dataframe of measures at different points
df.meanmeasures.evolution=around%>%map_dfr(function(x)  df.measures %>% left_join(df.maxdeaths, by = 'RegionName') %>%
filter(date > (date.min30+x) & date < (date.plus30+x))%>%mutate(reference=x)%>% group_by(RegionName,reference) %>% summarise_if(is.numeric, mean, na.rm = TRUE) %>%
mutate(across(where(is.numeric), round, 3)))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=pca_fit$center,scale=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+geom_text(aes(label=RegionName))
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()
around=c(-60,0,60)
#Create dataframe of measures at different points
df.meanmeasures.evolution=around%>%map_dfr(function(x)  df.measures %>% left_join(df.maxdeaths, by = 'RegionName') %>%
filter(date > (date.min30+x) & date < (date.plus30+x))%>%mutate(reference=x)%>% group_by(RegionName,reference) %>% summarise_if(is.numeric, mean, na.rm = TRUE) %>%
mutate(across(where(is.numeric), round, 3)))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=pca_fit$center,scale=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point(aes(pch=RegionName))
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=as.factor(reference)))+
geom_point()+geom_line(aes(group=RegionName))
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName))
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_fill_continuous(palette='diverge_hcl')
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_fill_continuous(palette='diverge_hsv')
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_color_continuous(palette='diverge_hsv')
ggplot(evolution.measures%>%filter(reference!=-0.5),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_color_gradient(low="blue", high="red")
ggplot(evolution.measures%>%filter(reference!=-0.5)%>%sample(9),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 3,nrow = 3)
evolution.measures
ggplot(evolution.measures%>%filter(reference!=-0.5)%>%sample(size = 9),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 3,nrow = 3)
evolution.measures
evolution.measures%>%sample(9)
evolution.measures%>%sample(size = 9)
evolution.measures%>%sample(size = 9)
estados=sample(unique(evolution.measures$RegionName),size = 9)
ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 3,nrow = 3)
#Define times of analysis
around=c(-60,-45,-15,0,15,30,45,60)
#Create dataframe of measures at different points
df.meanmeasures.evolution=around%>%map_dfr(function(x)  df.measures %>% left_join(df.maxdeaths, by = 'RegionName') %>%
filter(date > (date.min30+x) & date < (date.plus30+x))%>%mutate(reference=x)%>% group_by(RegionName,reference) %>% summarise_if(is.numeric, mean, na.rm = TRUE) %>%
mutate(across(where(is.numeric), round, 3)))
evolution.measures=around%>%map_dfr(function(x) (df.meanmeasures.evolution%>%select(-'H5_Investment in vaccines',-'newdeaths')%>%filter(reference==x)%>%
mutate(across(where(is.numeric),~ifelse(is.nan(.x),yes=0,no=.x)))%>%as.data.frame()%>%select(-RegionName,-reference)%>%scale( center=pca_fit$center,scale=pca_fit$scale)) %*% pca_fit$rotation%>%
as.data.frame()%>%select(PC1,PC2)%>%mutate(reference=x,RegionName=df.meanmeasures.evolution$RegionName[df.meanmeasures.evolution$reference==x]))
estados=sample(unique(evolution.measures$RegionName),size = 9)
ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 3,nrow = 3)
estados=sample(unique(evolution.measures$RegionName),size = 16)
ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_line(aes(group=RegionName),color='black')+scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 4,nrow = 4)
ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 4,nrow = 4)
estados=sample(unique(evolution.measures$RegionName),size = 49)
ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 7,nrow = 7)
ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 7,nrow = 7)+
xlim(-6,6)+ylim(-3,3)
full_evolution=ggplot(evolution.measures,aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 7,nrow = 8)
full_evolution
estados=c('Utah','Vermont','New York','Pennsylvania')
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 2)
selected_evolution
estados=c('Utah','North Dakota','Maine','South Carolina','Vermont','Pennsylvania','New York','Maryland')
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 3)
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+labs('Days since peak new deaths')
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+labs(color='Days since peak new deaths')
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+labs(color='Days since peak')
selected_evolution
p.dims.states
df.coords.pc
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel( aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27),color=type), size = 2.5,alpha=1, vjust=1)+
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel( aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27),color=type), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27),color=type), size = 2.5,alpha=1, vjust=1)
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27),color=type), size = 2.5,alpha=1, vjust=1)
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27),color=type), size = 2.5,alpha=1, vjust=1)
selected_evolution
Dim.1
df.coords.pc$Dim.1+1
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=Dim.1, y=Dim.2, label=substr(name_clean,1,27),color=type), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(data=evolution.measures%>%filter(RegionName%in%estados),aes(x=PC1,y=PC2,color=(reference)))+
geom_point()+geom_path(aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected.states=evolution.measures%>%filter(RegionName%in%estados)
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")
nrow(evolution.measures%>%filter(PC1>-6&PC1<6))
selected_evolution
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected.states
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(data=selected.states,low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(data=selected.states,low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)
View(df.coords.pc)
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=selected.states,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1)
selected_evolution
df.coords.pc
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=selected.states,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black")+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=selected.states,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=selected.states,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)
selected_evolution
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
df.coords.pc
df.coords.pc.2=df.coords.pc%>%filter(varnames%in%most_variance_category)
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=5*Dim.1, y=5*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=10*Dim.1, y=10*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=10*Dim.1, y=10*Dim.2, label=substr(name_clean,1,27)), size = .5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=10*Dim.1, y=10*Dim.2, label=substr(name_clean,1,27)), size = .7,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=10*Dim.1, y=10*Dim.2, label=substr(name_clean,1,27)), size = 1,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=10*Dim.1, y=10*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=0.5, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red")+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=0.5, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red",mid='white')+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=0.5, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red",middle='white')+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=0.5, vjust=1,inherit.aes = FALSE)
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradient(low="blue", high="red",middle='white')+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=0.25, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_text(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label(data=df.coords.pc.2, mapping =aes(x=10*Dim.1, y=10*Dim.2, label=substr(name_clean,1,27)), size = 2.5,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","white","red"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","red","green"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","red","green"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)+
labs(color='Days since peak')+theme(legend.position="bottom",legend.spacing.x = unit(0.5, 'cm'))+guides(fill = guide_legend(label.position = "bottom"))
selected_evolution
selected.measures=
selected_evolution=ggplot(data=selected.states,aes(x=PC1,y=PC2,color=(reference)))+
geom_segment(data=df.coords.pc.2,mapping =aes(x=0, y=0, xend=5*Dim.1, yend=5*Dim.2), arrow=arrow(length=unit(0.2,"cm")), alpha=1, color="black",inherit.aes = FALSE)+
geom_label_repel(data=df.coords.pc.2, mapping =aes(x=15*Dim.1, y=15*Dim.2, label=substr(name_clean,1,27)), size = 2,alpha=1, vjust=1,inherit.aes = FALSE)+
geom_point(data=selected.states)+geom_path(data=selected.states,mapping=aes(group=RegionName,color=reference))+
scale_color_gradientn(colours=c("blue","red","green"))+facet_wrap(~RegionName,ncol = 2,nrow = 4)
selected_evolution
